{% extends "base.html" %}
{% load i18n %}

{% block content %}

<h1 class="text-center">{% trans "Home" %}</h1>

{% if user.is_authenticated %}
<form method="post" action="/accounts/logout/">
  {% csrf_token %}
  <button type="submit" class="btn btn-secondary">{% trans "Logout" %}</button>
</form>
{% else %}
  <a href="{% url 'login' %}" class="btn btn-primary mb-3">Login</a> 
{% endif %}

{% if albums %}
  <h2>{% trans "Albums" %}</h2>
  <ul class="list-group">
    {% for a in albums %}
      <li class="list-group-item">
        {% if a.cover_image %}
          <img src="{{ a.cover_image.url }}"
               alt="{{ a.title }} cover"
               style="width: 50px; height: 50px; object-fit: cover; margin-right: 8px;">
        {% endif %}
        <a href="{% url 'album_detail' a.id %}">{{ a.title }}</a>
      </li>
    {% endfor %}
  </ul>
{% endif %}

{% if playlists %}
  <h2>{% trans "Playlists" %}</h2>
  <ul class="list-group">
    {% for p in playlists %}
      <li class="list-group-item">
        <strong>{{ p.name }}</strong>
        <ul>
          {% for s in p.songs.all %}
            <li>
              <a href="/songs/{{ s.id }}/">{{ s.title }}</a>
              â€” {{ s.album.title }}
            </li>
          {% empty %}
            <li>{% trans "No songs in this playlist" %}</li>
          {% endfor %}
        </ul>
      </li>
    {% empty %}
      <li>{% trans "No playlists" %}</li>
    {% endfor %}
  </ul>
{% endif %}

{% if songs %}
  <h2>{% trans "Songs" %}</h2>

  <p>Total results found: {{ songs|length }}</p>

  <ul class="list-group">
    {% for s in songs %}
      <li class="list-group-item">
        <a href="{% url 'song_detail' s.id %}">{{ s.title }}</a>
        ({{ s.album.title }})
      </li>
    {% endfor %}
  </ul>
{% endif %}

{% endblock %}